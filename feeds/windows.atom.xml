<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>幽谷奇峰 | 燕雀鸣幽谷，鸿鹄掠奇峰</title><link href="http://yysfire.github.io/" rel="alternate"></link><link href="http://yysfire.github.io/feeds/windows.atom.xml" rel="self"></link><id>http://yysfire.github.io/</id><updated>2014-11-23T07:06:03+08:00</updated><entry><title>如何在 Windows7 系统不重启或注销的情况下使环境变量的修改立即全局生效</title><link href="http://yysfire.github.io/windows/How_to_modify_environment_variables_and_take_it_effect_immediately_without_reboot_or_logout_Windows7.html" rel="alternate"></link><updated>2014-11-23T07:06:03+08:00</updated><author><name>Yysfire</name></author><id>tag:yysfire.github.io,2014-11-23:windows/How_to_modify_environment_variables_and_take_it_effect_immediately_without_reboot_or_logout_Windows7.html</id><summary type="html">
&lt;p&gt;关于这个问题，网上的文章特别多，但很多都是重复的、过时的、无效的。但此问题是确确实实可以实现的，因为不少软件在安装的时候就会修改环境变量，安装完成后，这些修改就立马生效了。本文就介绍一下作者解决此问题的亲身经历及体会。&lt;/p&gt;
&lt;p&gt;作者为了搭建 node.js 及 npm 工作环境（搭建过程见：&lt;a href="http://yysfire.github.io/tools/How_to_build_a_portable_node.js_and_npm_working_environment_in_Windows7"&gt;如何在 Windows7 下搭建绿色便携的 node.js 及 npm 工作环境&lt;/a&gt;），需要修改 PATH 环境变量，并添加一个新的环境变量。下面就仅以 PATH 变量为例来做介绍。&lt;/p&gt;
&lt;h2 id="rapid-environment-editor"&gt;用软件 Rapid Environment Editor 来修改&lt;/h2&gt;
&lt;p&gt;这是我的系统已经装有的一个软件，可以快速修改 Windows 的系统环境变量和用户环境变量。它具备对环境变量进行编辑、添加、删除、排序、备份，以及清理无效路径的功能。软件界面如下（红色表示该路径不存在或无权访问，灰色表示系统的关键环境变量）：&lt;/p&gt;
&lt;p&gt;&lt;img alt="Rapid Environment Editor" src="../images/Rapid.Environment.Editor.JPG"/&gt;&lt;/p&gt;
&lt;p&gt;我用此软件修改完 PATH 环境变量（为保险起见，也为了做个对比，我在用户环境变量的 PATH 变量和系统环境变量的 PATH 变量中都作了修改），并点“保存”后，打开新的 cmd 命令行窗口，运行 &lt;code&gt;echo %PATH%&lt;/code&gt;，发现修改并未生效，即使是重启 explorer 进程，也依然 &lt;strong&gt;无效&lt;/strong&gt; 。看来，此软件除了上述功能外，也没什么强力之处。&lt;/p&gt;
&lt;h2 id="_1"&gt;直接修改注册表&lt;/h2&gt;
&lt;p&gt;既然第三方软件修改无果，那我就直接拿注册表开刀呗，心想着这总应该能成吧。注册表中有三个项保存着环境变量的信息，它们分别是：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;HKEY_CURRENT_USER\Environment&lt;/code&gt; 保存着用户环境变量的信息&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Session Manager\Environment&lt;/code&gt; 保存着系统环境变量当前的信息&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&lt;/code&gt; 和上面第二个一模一样，实际就是指向上面第二个的链接&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HKEY_LOCAL_MACHINE\SYSTEM\ControlSet002\Control\Session Manager\Environment&lt;/code&gt; 保存着系统环境变量上一次的信息&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;我用 Registry Workshop（这个软件比系统自带的 regedit 好用多了） 打开注册表，发现上面前三个的 PATH 键中已经保存着我之前用 Rapid Environment Environment 所做的修改，我就索性把第四个的 PATH 键值也给改了，然后打开新的 cmd，运行 &lt;code&gt;echo %PATH%&lt;/code&gt;，发现修改仍未生效，再次重启 explorer 进程，再一次 &lt;strong&gt;失败了&lt;/strong&gt; 。&lt;/p&gt;
&lt;h2 id="-"&gt;计算机-&amp;gt;属性-&amp;gt;高级系统设置-&amp;gt;环境变量&lt;/h2&gt;
&lt;p&gt;那就回归到最原始、最简单的方法中来吧，在“计算机“右键菜单-&amp;gt;“属性”-&amp;gt;“高级系统设置”-&amp;gt;“环境变量”中修改完 PATH 变量后，一路点确定，然后打开新的 cmd 窗口，运行 &lt;code&gt;echo %PATH%&lt;/code&gt;，发现 &lt;strong&gt;修改竟然生效了&lt;/strong&gt; 。我无语了，原来 &lt;strong&gt;有时候最简单的方法却是最有效的&lt;/strong&gt; ，之前把问题想复杂了，所以没有一开始就用这个方法。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;注意：修改完环境变量后，必须要通过“开始菜单”-&amp;gt;“附件”-&amp;gt;“命令提示符”或者“运行”对话框（可用快捷键 Win+R 打开）打开新的 cmd 窗口，才能看到生效了的环境变量。换句话说，只有在修改完成之后开启的进程，才能加载修改过的环境变量。而那些修改发生之前就已经在运行的进程，它们加载的仍然是修改之前的环境变量值，只要它们不退出，由它们开启的子进程所加载的也很有可能仍然是修改前的环境变量值。&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;举个例子来说明：你先打开了 Double Commander（一款功能类似 Total Commander 的开源免费跨平台的文件管理器，界面如下图所示），然后修改了 PATH 环境变量，再通过 Double Commander 运行了一个 cmd 窗口，在里面运行 &lt;code&gt;echo %PATH%&lt;/code&gt;，你会发现改动没有生效。只有先退出、再打开 Double Commander，然后通过它运行的 cmd 窗口，才会加载改动后的 PATH 变量值。&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Double Commander" src="../images/Double.Commander.0-5-10.beta.build.5514M-.2014-05-12.png"/&gt;&lt;/p&gt;
&lt;h2 id="_2"&gt;结论&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;不重启或注销 Windows7 系统而使环境变量的修改能生效的方法是：在“计算机“右键菜单-&amp;gt;“属性”-&amp;gt;“高级系统设置”-&amp;gt;“环境变量”中修改，然后一路点确定直到关闭了“系统属性”对话框。&lt;/li&gt;
&lt;li&gt;修改环境变量后，如果该环境变量影响的是应用程序，那么只需要重启该程序即可生效。但是，如果影响的是系统服务，就必须重启系统才能将环境变量的修改反映到系统服务中。&lt;/li&gt;
&lt;/ol&gt;</summary><category term="Windows7"></category><category term="Windows"></category><category term="Environment variable"></category><category term="环境变量"></category><category term="注册表"></category><category term="Rapid Environment Editor"></category></entry><entry><title>Windows平台便携版Evernote的制作与下载</title><link href="http://yysfire.github.io/windows/make_and_download_portable-evernote_for_windows.html" rel="alternate"></link><updated>2014-11-18T06:11:34+08:00</updated><author><name>Yysfire</name></author><id>tag:yysfire.github.io,2014-11-18:windows/make_and_download_portable-evernote_for_windows.html</id><summary type="html">
&lt;p&gt;使用便携软件的好处就不用我赘述了，本人是有着轻微强迫症的便携软件的狂热粉丝，我在windows平台下使用的大部分软件都是便携版的。PortableApps.com Platform 是Windows系统下比较流行的便携软件平台，PortableApps.com Launcher（以下简称PAL）是PortableApps.com开发的便携软件制作工具。本文就介绍如何制作兼容PortableApps.com Platform的便携版Evernote。&lt;/p&gt;
&lt;h2 id="evernote"&gt;提取Evernote程序文件&lt;/h2&gt;
&lt;p&gt;先到Evernote官网上下载最新的Evernote安装程序，然后到
&lt;a href="http://legroom.net/software/uniextract"&gt;这里&lt;/a&gt;
下载提取工具Universal Extractor， 建议下载Archive版（便携版）。&lt;/p&gt;
&lt;p&gt;不能直接用Universal Extractor提取Evernote官方安装包，否则会出现错误而失败。要先运行一下Evernote官方安装包，等到弹出安装对话框时，点击“取消”退出安装程序，它会在&lt;code&gt;%TEMP%&lt;/code&gt;路径（对于Win7就是：C:\Users\Administrator\AppData\Local\Temp）下生成一个名为&lt;code&gt;Evernote.msi&lt;/code&gt;的Windows Installer（MSI）包，对此包用Universal Extractor提取就可得到所需的纯净的程序文件。&lt;/p&gt;
&lt;h2 id="_1"&gt;分析程序运行机理&lt;/h2&gt;
&lt;p&gt;运行Evernote，发现它会启动Evernote.exe，EvernoteClipper.exe，EvernoteTray.exe这三个进程，在&lt;code&gt;%APPDATA%&lt;/code&gt;、&lt;code&gt;%LOCALAPPDATA%&lt;/code&gt;以及NT6.0以上的LocalLow中写入文件，在注册表&lt;code&gt;HKCU\Software\Evernote&lt;/code&gt;中写入键值，&lt;code&gt;HKCU\Software\Evernote\Evernote\EvernotePath&lt;/code&gt;的值为Evernote数据库的位置。Evernote首次运行还会在&lt;code&gt;shell:sendto&lt;/code&gt;中创建一个指向Evernote.exe的快捷方式，以便文件的右键菜单中有“发送到Evernote”的菜单。&lt;/p&gt;
&lt;h2 id="_2"&gt;编写配置文件&lt;/h2&gt;
&lt;p&gt;我们的目标是利用PAL制作这样一个便携软件启动器（Launcher）：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Launcher启动—&amp;gt;备份本地数据—&amp;gt;导入便携数据—&amp;gt;将数据库路径写入注册表—&amp;gt;启动主程序—&amp;gt;主程序退出—&amp;gt;导出便携软件数据—&amp;gt;清理便携软件垃圾—&amp;gt;恢复本地数据—&amp;gt;Launcher退出&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;PortableApps.com 提供了一个模板：
&lt;a href="http://downloads.sourceforge.net/portableapps/PortableApps.com_Application_Template_2.4.zip"&gt;PortableApps.com Application Template 2.4&lt;/a&gt;，
以便我们快速部署配置文件。&lt;/p&gt;
&lt;h3 id="appinfoini"&gt;appinfo.ini&lt;/h3&gt;
&lt;p&gt;下载上述模板，解压后，重命名AppNamePortable为EvernotePortable。在App下新建Evernote目录，将提取出的程序文件复制到此处。&lt;/p&gt;
&lt;p&gt;创建 App\AppInfo\appinfo.ini ，此目录下的文件主要是为PortableApps.com Platform提供程序的基本信息。使用PAL创建便携软件，此目录是不可缺少的。&lt;/p&gt;
&lt;p&gt;在appinfo.ini中这样写：&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="k"&gt;[Format]&lt;/span&gt;
&lt;span class="na"&gt;Type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;PortableApps.comFormat&lt;/span&gt;
&lt;span class="na"&gt;Version&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;3.0&lt;/span&gt;

&lt;span class="k"&gt;[Details]&lt;/span&gt;
&lt;span class="na"&gt;Name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Evernote Portable&lt;/span&gt;
&lt;span class="na"&gt;AppID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;EvernotePortable&lt;/span&gt;
&lt;span class="na"&gt;Publisher&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Evernote Corporation | yysfire&lt;/span&gt;
&lt;span class="na"&gt;Homepage&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;http://yysfire.github.io/tools/&lt;/span&gt;
&lt;span class="na"&gt;Category&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Office&lt;/span&gt;
&lt;span class="na"&gt;Language&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Multilingual&lt;/span&gt;
&lt;span class="na"&gt;Description&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Save your ideas, things you like, things you hear, and things you see.&lt;/span&gt;

&lt;span class="k"&gt;[License]&lt;/span&gt;
&lt;span class="na"&gt;Shareable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;true&lt;/span&gt;
&lt;span class="na"&gt;OpenSource&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;false&lt;/span&gt;
&lt;span class="na"&gt;Freeware&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;true&lt;/span&gt;
&lt;span class="na"&gt;CommercialUse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;true&lt;/span&gt;

&lt;span class="k"&gt;[Version]&lt;/span&gt;
&lt;span class="na"&gt;PackageVersion&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;5.7.1.5586&lt;/span&gt;
&lt;span class="na"&gt;DisplayVersion&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;5.7.1&lt;/span&gt;

&lt;span class="k"&gt;[Control]&lt;/span&gt;
&lt;span class="na"&gt;Icons&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;1&lt;/span&gt;
&lt;span class="na"&gt;Start&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;EvernotePortable.exe&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;h3 id="_3"&gt;图标&lt;/h3&gt;
&lt;p&gt;导出Evernote.exe的图标，推荐使用&lt;a href="http://portableapps.com/apps/graphics_pictures/icofx_portable"&gt;IcoFX Portable&lt;/a&gt;，保存为&lt;code&gt;App\AppInfo\appicon.ico&lt;/code&gt;，并导出为appicon_16.png（16px），appicon_32.png（32px），appicon_128.png（128px，非必须），均放在&lt;code&gt;App\AppInfo\&lt;/code&gt;路径下。&lt;/p&gt;
&lt;h3 id="launcher"&gt;Launcher&lt;/h3&gt;
&lt;p&gt;创建&lt;code&gt;App\Appinfo\Launcher\EvernotePortable.ini&lt;/code&gt;，这个INI是制作便携软件的关键，它告诉PAL如何使我们的软件便携化。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;参考：&lt;a href="http://www.portableappc.com/guide/pal-guide/"&gt;使用Portableapps.com Launcher制作便携软件：以Evernote Portable为例&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="k"&gt;[Launch]&lt;/span&gt;
&lt;span class="na"&gt;ProgramExecutable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;Evernote\Evernote.exe&lt;/span&gt;
&lt;span class="c1"&gt;;主程序位置&lt;/span&gt;
&lt;span class="na"&gt;SinglePortableAppInstance&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;true&lt;/span&gt;
&lt;span class="c1"&gt;;只允许运行一个便携版实例&lt;/span&gt;
&lt;span class="na"&gt;CloseEXE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;EvernoteTray.exe&lt;/span&gt;
&lt;span class="c1"&gt;;除了Evernote.exe，当EvernoteTray.exe正在运行时，便携软件也拒绝启动。&lt;/span&gt;
&lt;span class="na"&gt;WaitForExe1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;EvernoteTray.exe&lt;/span&gt;
&lt;span class="c1"&gt;;当Evernote.exe关闭后，等待EvernoteTray.exe进程退出,EvernotePortable.exe才退出，才真正结束便携软件。&lt;/span&gt;
&lt;span class="na"&gt;DirectoryMoveOK&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;yes&lt;/span&gt;
&lt;span class="c1"&gt;;路径改变并不会影响便携软件运行，因此检测到路径改变时不提示警告。&lt;/span&gt;

&lt;span class="k"&gt;[Activate]&lt;/span&gt;
&lt;span class="na"&gt;Registry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;true&lt;/span&gt;
&lt;span class="c1"&gt;;表示本软件需要写注册表&lt;/span&gt;

&lt;span class="k"&gt;[DirectoriesMove]&lt;/span&gt;
&lt;span class="na"&gt;-&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;%LOCALAPPDATA%\Evernote&lt;/span&gt;
&lt;span class="c1"&gt;;当软件启动时，原%LOCALAPPDATA%\Evernote会被重命名（备份）为&lt;/span&gt;
&lt;span class="c1"&gt;;%LOCALAPPDATA%\Evernote-Backup-by-EvernotePortable，当软&lt;/span&gt;
&lt;span class="c1"&gt;;件结束时，%LOCALAPPDATA%\Evernote会被删除，&lt;/span&gt;
&lt;span class="c1"&gt;;%LOCALAPPDATA%\Evernote-Backup-by-EvernotePortable 被重命名（恢复）&lt;/span&gt;
&lt;span class="c1"&gt;;为%LOCALAPPDATA%\Evernote。（-=）的意思是程序结束时不将&lt;/span&gt;
&lt;span class="c1"&gt;;%LOCALAPPDATA%\Evernote备份到便携软件Data目录，因为这几个目录主要是日志、&lt;/span&gt;
&lt;span class="c1"&gt;;临时文件，没有备份到便携设备的必要。如果需要备份到Data目录，则将“-”指定为其&lt;/span&gt;
&lt;span class="c1"&gt;;他名称。下同。&lt;/span&gt;
&lt;span class="na"&gt;-&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;%APPDATA%\Evernote&lt;/span&gt;
&lt;span class="na"&gt;-&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;%USERPROFILE%\AppData\LocalLow\Evernote&lt;/span&gt;

&lt;span class="k"&gt;[DirectoriesCleanupIfEmpty]&lt;/span&gt;
&lt;span class="na"&gt;1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;%LOCALAPPDATA%\Evernote\Evernote&lt;/span&gt;
&lt;span class="c1"&gt;;如为空目录，则在结束时删除目录，避免留下垃圾文件。下同&lt;/span&gt;
&lt;span class="na"&gt;2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;%LOCALAPPDATA%\Evernote&lt;/span&gt;
&lt;span class="na"&gt;3&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;%APPDATA%\Evernote&lt;/span&gt;
&lt;span class="na"&gt;4&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;%USERPROFILE%\AppData\LocalLow\Evernote&lt;/span&gt;

&lt;span class="k"&gt;[RegistryKeys]&lt;/span&gt;
&lt;span class="na"&gt;EvernotePortable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;HKCU\Software\Evernote&lt;/span&gt;
&lt;span class="c1"&gt;;在程序启动时，HKCU\Software\Evernote被重命名为&lt;/span&gt;
&lt;span class="c1"&gt;;HKCU\Software\Evernote-Backup-by-EvernotePortable，&lt;/span&gt;
&lt;span class="c1"&gt;;Data\settings\EvernotePortable.reg 被导入注册表，在程&lt;/span&gt;
&lt;span class="c1"&gt;;序结束后，反过来导出便携软件键值，恢复本机注册表项。&lt;/span&gt;

&lt;span class="k"&gt;[RegistryValueWrite]&lt;/span&gt;
&lt;span class="na"&gt;HKCU\Software\Evernote\Evernote\EvernotePath&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;REG_SZ:%PAL:DataDir%&lt;/span&gt;
&lt;span class="c1"&gt;;在程序启动时，在HKCU\Software\Evernote\Evernote\EvernotePath 中写入便携&lt;/span&gt;
&lt;span class="c1"&gt;;软件Data目录路径，以将数据库目录设定为便携软件的Data。更多PAL专有变量请参阅文档。&lt;/span&gt;

&lt;span class="k"&gt;[RegistryCleanupIfEmpty]&lt;/span&gt;
&lt;span class="na"&gt;1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;HKCU\Software\Evernote&lt;/span&gt;
&lt;span class="c1"&gt;;如为空项，则在结束时删除，避免留下注册表垃圾。&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;h3 id="defaultdata"&gt;DefaultData&lt;/h3&gt;
&lt;p&gt;PortableApps.com Platform 便携软件一般是不能通过软件自身的升级方式更新的，因此，我们需要修改程序的默认设置，关闭自动升级选项。通过观察注册表，可知Evernote自动升级主要由2个键值控制。在程序第一次运行时，需要将这两个键值设为0，以关闭默认升级。&lt;/p&gt;
&lt;p&gt;新建&lt;code&gt;App\DefaultData\settings\EvernotePortable.reg&lt;/code&gt;，写入如下内容：&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;Windows Registry Editor Version 5.00

&lt;span class="k"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;HKEY_CURRENT_USER&lt;/span&gt;&lt;span class="k"&gt;\Software\Evernote\Evernote]&lt;/span&gt;
&lt;span class="na"&gt;"UpdateToPreReleaseVersion"&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;dword&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="m"&gt;00000000&lt;/span&gt;
&lt;span class="na"&gt;"CheckForUpdatesAtLaunch"&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;dword&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="m"&gt;00000000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;h3 id="custom-code"&gt;Custom Code&lt;/h3&gt;
&lt;p&gt;Evernote有一个残余进程EvernoteClipper.exe，并不会在程序结束后自动退出。PAL并没有结束进程的功能，因此需要用到一段Custom Code。在&lt;code&gt;App\AppInfo\Launcher&lt;/code&gt;目录下新建Custom.nsh，写入如下内容：&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;SegmentFile&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;

&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;SegmentPrePrimary&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
KillProcDLL::KillProc "EvernoteClipper.exe"
!macroend

&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;SegmentPostPrimary&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
KillProcDLL::KillProc "EvernoteClipper.exe"
!macroend
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;p&gt;此代码的作用是调用NSIS的KillPorcDLL插件，在程序启动之前和退出之后，结束进程EvernoteClipper.exe。但是，似乎并不起作用。&lt;/p&gt;
&lt;p&gt;其实，EvernoteClipper.exe并没有什么大作用，关闭它对主程序没什么影响，而它的启动是由注册表中的一个键值
&lt;code&gt;HKEY_CURRENT_USER\Software\Evernote\Evernote\StartEvernoteClipper&lt;/code&gt;
来控制。因此，我们可以在&lt;code&gt;App\DefaultData\settings\EvernotePortable.reg&lt;/code&gt;中加入&lt;code&gt;"StartEvernoteClipper"=dword:00000000&lt;/code&gt;来关闭它的启动。&lt;/p&gt;
&lt;p&gt;我在前面还提到，在Evernote首次启动时，会添加“发送到Evernote”的右键菜单。但是，当Evernote程序退出后，此右键菜单还存在，这不符合便携软件的理念。&lt;/p&gt;
&lt;p&gt;解决这个问题无外乎两种思路：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;思路一：完全抛弃此右键菜单，想办法让Evernote不安装这个菜单。&lt;/li&gt;
&lt;li&gt;思路二：右键发送到Evernote的菜单有时还是挺好用的，当启动便携版Evernote时，生成此菜单，当便携版Evernote退出后，就删掉此菜单。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;对于思路一，我找到了控制Evernote安装右键菜单的注册表键值：&lt;code&gt;HKEY_CURRENT_USER\Software\Evernote\Evernote\SendToLinkInstalled&lt;/code&gt;，在&lt;code&gt;App\DefaultData\settings\EvernotePortable.reg&lt;/code&gt;中将此键值清零，结果好象不起作用。&lt;/p&gt;
&lt;p&gt;对于思路二，可以在&lt;code&gt;App\AppInfo\Launcher\Custom.nsh&lt;/code&gt;中写入以下代码解决：&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="sx"&gt;!define SENDTO   `$SENDTO\Evernote.lnk`&lt;/span&gt;

$&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;SegmentFile&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

$&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;SegmentPrePrimary&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;ExpandEnvStrings&lt;/span&gt; $&lt;span class="mi"&gt;0&lt;/span&gt; "&lt;span class="c"&gt;%PAL:AppDir%\Evernote\Evernote.exe"&lt;/span&gt;
    &lt;span class="n"&gt;CreateShortCut&lt;/span&gt; `$&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;SENDTO&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;` `$&lt;span class="mi"&gt;0&lt;/span&gt;`
&lt;span class="sx"&gt;!macroend&lt;/span&gt;

$&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;SegmentPostPrimary&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;Delete&lt;/span&gt; `$&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;SENDTO&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;`
&lt;span class="sx"&gt;!macroend&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;p&gt;综合以上，文件&lt;code&gt;D:\PortableApps\EvernotePortable\App\AppInfo\Launcher\Custom.nsh&lt;/code&gt;最终的内容如下：&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="sx"&gt;!define SENDTO   `$SENDTO\Evernote.lnk`&lt;/span&gt;

$&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;SegmentFile&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

$&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;SegmentPrePrimary&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;ExpandEnvStrings&lt;/span&gt; $&lt;span class="mi"&gt;0&lt;/span&gt; "&lt;span class="c"&gt;%PAL:AppDir%\Evernote\Evernote.exe"&lt;/span&gt;
    &lt;span class="n"&gt;CreateShortCut&lt;/span&gt; `$&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;SENDTO&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;` `$&lt;span class="mi"&gt;0&lt;/span&gt;`
    &lt;span class="n"&gt;KillProcDLL&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;KillProc&lt;/span&gt; "&lt;span class="n"&gt;EvernoteClipper&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exe&lt;/span&gt;"
&lt;span class="sx"&gt;!macroend&lt;/span&gt;

$&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;SegmentPostPrimary&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;Delete&lt;/span&gt; `$&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;SENDTO&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;`
    &lt;span class="n"&gt;KillProcDLL&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;KillProc&lt;/span&gt; "&lt;span class="n"&gt;EvernoteClipper&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exe&lt;/span&gt;"
&lt;span class="sx"&gt;!macroend&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;p&gt;文件&lt;code&gt;App\DefaultData\settings\EvernotePortable.reg&lt;/code&gt;最终的内容如下：&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;Windows Registry Editor Version 5.00

&lt;span class="k"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;HKEY_CURRENT_USER&lt;/span&gt;&lt;span class="k"&gt;\Software\Evernote\Evernote]&lt;/span&gt;
&lt;span class="na"&gt;"UpdateToPreReleaseVersion"&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;dword&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="m"&gt;00000000&lt;/span&gt;
&lt;span class="na"&gt;"CheckForUpdatesAtLaunch"&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;dword&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="m"&gt;00000000&lt;/span&gt;
&lt;span class="na"&gt;"StartEvernoteClipper"&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;dword&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="m"&gt;00000000&lt;/span&gt;
&lt;span class="na"&gt;"SendToLinkInstalled"&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;dword&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="m"&gt;00000000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;h2 id="_4"&gt;编译与封包&lt;/h2&gt;
&lt;p&gt;Evernote的便携化基本完成了。在
&lt;a href="http://portableapps.com/apps/development/portableapps.com_launcher"&gt;PortableApps.com Launcher&lt;/a&gt;
中载入 EvernotePortable 目录，按下一步编译。如果成功，会在 EvernotePortable 目录下生成 EvernotePortable.exe。&lt;/p&gt;
&lt;p&gt;至此便携软件已经制作完毕，为便于使用与分发，可使用
&lt;a href="http://portableapps.com/apps/utilities/portableapps.com_appcompactor"&gt;PortableApps.com AppCompactor&lt;/a&gt;
减小软件体积，使用
&lt;a href="http://portableapps.com/apps/development/portableapps.com_installer"&gt;PortableApps.com Installer&lt;/a&gt; 制作成安装（自解压）包。&lt;/p&gt;
&lt;h2 id="_5"&gt;扩展阅读&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="http://portableapps.com/development/portableapps.com_format"&gt;PortableApps.com Format Specification (3.0)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://portableapps.com/manuals/PortableApps.comLauncher/"&gt;PortableApps.com Launcher Manual&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr/&gt;
&lt;h2 id="evernote_1"&gt;Evernote便携版下载地址&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;EvernotePortable_5.7.1.5586 下载地址&lt;/strong&gt; ：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.t00y.com/file/78512770"&gt;城通网盘&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://pan.baidu.com/s/1jG1MbR4"&gt;百度云盘&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://onedrive.live.com/?cid=3E5BAA7041F5AC70&amp;amp;id=3E5BAA7041F5AC70!110"&gt;OneDrive&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="Evernote"></category><category term="PortableApps"></category><category term="Windows"></category><category term="PAL"></category></entry><entry><title>如何去掉快捷方式的小箭头</title><link href="http://yysfire.github.io/windows/How_to_remove_the_arrow_mark_of_shortcut_in_windows.html" rel="alternate"></link><updated>2011-09-29T23:39:00+08:00</updated><author><name>Yysfire</name></author><id>tag:yysfire.github.io,2011-09-29:windows/How_to_remove_the_arrow_mark_of_shortcut_in_windows.html</id><summary type="html">&lt;p&gt;在windows系统中，桌面的快捷方式图标总是带有一个小箭头，非常不美观，有三种方法去掉它：&lt;/p&gt;
&lt;p&gt;1、运行注册表编辑器（在“运行”中运行“regedit”），删除&lt;code&gt;HKEY_CLASSES_ROOT\lnkfile&lt;/code&gt;子键的一个名为“IsShortcut”的键值，关闭注册表编辑器，重启系统（或注销后再进入）。&lt;/p&gt;
&lt;p&gt;2、使用优化大师，然后进入使用性能优化，选择系统个性设置，在“消除快捷方式图标上的小箭头”前打勾，重启后就OK啦。&lt;/p&gt;
&lt;p&gt;3、打开IE，将浏览器窗口缩至合适的大小。单击“开始”菜单，在“程序”中选中并按住鼠标左键拖动应用程序图标到浏览器任意空白处。如果想保留“开始”菜单中的应用程序图标，拖动时可以按住Ctrl键，然后释放鼠标左键，此时系统会弹出一个询问是打开应用程序还是保存到磁盘的对话框，选择保存到磁盘选项，单击“确定”，接下来系统会弹出一个保存窗口，我们选择保存路径为桌面，然后单击“确定”。再看一看，“快捷方式到”和小箭头是不是没有出现？&lt;/p&gt;
&lt;p&gt;参考资料：&lt;a href="http://bbs.cwb11.com/dispbbs.asp?BoardID=8&amp;amp;id=2867"&gt;http://bbs.cwb11.com/dispbbs.asp?BoardID=8&amp;amp;id=2867&lt;/a&gt;&lt;/p&gt;</summary><category term="Windows"></category><category term="快捷方式"></category><category term="Shortcut"></category></entry><entry><title>Windows XP下常用的运行命令</title><link href="http://yysfire.github.io/windows/Commanders_can_be_used_in_Run_dialog_of_Windows_XP.html" rel="alternate"></link><updated>2011-09-10T08:22:00+08:00</updated><author><name>Yysfire</name></author><id>tag:yysfire.github.io,2011-09-10:windows/Commanders_can_be_used_in_Run_dialog_of_Windows_XP.html</id><summary type="html">&lt;p&gt;本文标题中提到的“运行命令”是指：在系统默认配置下，可以在“运行”对话框（“开始”菜单——“运行”弹出，或者使用快捷键“Windows徽标键+R”弹出）中运行的命令。&lt;/p&gt;
&lt;p&gt;比较常用的：&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="n"&gt;regedit&lt;/span&gt;&lt;span class="err"&gt;            注册表编辑器&lt;/span&gt;
&lt;span class="n"&gt;regedt32&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;注册表编辑器（功能同上，但注意没有字母&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="err"&gt;）&lt;/span&gt;
&lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="err"&gt;                &lt;/span&gt;&lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="err"&gt;命令提示符&lt;/span&gt;
&lt;span class="n"&gt;notepad&lt;/span&gt;&lt;span class="err"&gt;            打开记事本&lt;/span&gt;
&lt;span class="n"&gt;calc&lt;/span&gt;&lt;span class="err"&gt;              &lt;/span&gt; &lt;span class="err"&gt;启动计算器&lt;/span&gt;
&lt;span class="n"&gt;mspaint&lt;/span&gt;&lt;span class="err"&gt;            画图板&lt;/span&gt;
&lt;span class="n"&gt;explorer&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;打开资源管理器&lt;/span&gt;
&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="err"&gt;              写字板&lt;/span&gt;
&lt;span class="n"&gt;msconfig&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;系统配置实用程序&lt;/span&gt;
&lt;span class="n"&gt;gpedit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;        &lt;/span&gt; &lt;span class="err"&gt;组策略&lt;/span&gt;
&lt;span class="n"&gt;services&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;      &lt;/span&gt; &lt;span class="err"&gt;本地服务设置&lt;/span&gt;
&lt;span class="n"&gt;regsvr32&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dll&lt;/span&gt;&lt;span class="err"&gt;  停止&lt;/span&gt;&lt;span class="n"&gt;dll&lt;/span&gt;&lt;span class="err"&gt;文件运行&lt;/span&gt;
&lt;span class="n"&gt;compmgmt&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;      &lt;/span&gt; &lt;span class="err"&gt;计算机管理&lt;/span&gt;
&lt;span class="n"&gt;mstsc&lt;/span&gt;&lt;span class="err"&gt;              远程桌面连接&lt;/span&gt;
&lt;span class="n"&gt;dxdiag&lt;/span&gt;&lt;span class="err"&gt;            &lt;/span&gt; &lt;span class="err"&gt;检查&lt;/span&gt;&lt;span class="n"&gt;directx&lt;/span&gt;&lt;span class="err"&gt;信息&lt;/span&gt;
&lt;span class="n"&gt;devmgmt&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;        设备管理器&lt;/span&gt;
&lt;span class="n"&gt;sndvol32&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;音量控制程序&lt;/span&gt;
&lt;span class="n"&gt;taskmgr&lt;/span&gt;&lt;span class="err"&gt;            任务管理器&lt;/span&gt;
&lt;span class="n"&gt;clipbrd&lt;/span&gt;&lt;span class="err"&gt;            剪贴板查看器&lt;/span&gt;
&lt;span class="n"&gt;osk&lt;/span&gt;&lt;span class="err"&gt;                打开屏幕键盘&lt;/span&gt;
&lt;span class="n"&gt;logoff&lt;/span&gt;&lt;span class="err"&gt;            &lt;/span&gt; &lt;span class="err"&gt;注销命令&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;较少用到的：&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="n"&gt;winver&lt;/span&gt;&lt;span class="err"&gt;            &lt;/span&gt; &lt;span class="err"&gt;检查&lt;/span&gt;&lt;span class="n"&gt;windows&lt;/span&gt;&lt;span class="err"&gt;版本&lt;/span&gt;
&lt;span class="n"&gt;wmimgmt&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;        打开&lt;/span&gt;&lt;span class="n"&gt;windows&lt;/span&gt;&lt;span class="err"&gt;管理体系结构&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wmi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;wupdmgr&lt;/span&gt;&lt;span class="err"&gt;            &lt;/span&gt;&lt;span class="n"&gt;windows&lt;/span&gt;&lt;span class="err"&gt;更新程序&lt;/span&gt;
&lt;span class="n"&gt;wscript&lt;/span&gt;&lt;span class="err"&gt;            &lt;/span&gt;&lt;span class="n"&gt;windows&lt;/span&gt;&lt;span class="err"&gt;脚本宿主设置&lt;/span&gt;
&lt;span class="n"&gt;winmsd&lt;/span&gt;&lt;span class="err"&gt;            &lt;/span&gt; &lt;span class="err"&gt;系统信息&lt;/span&gt;
&lt;span class="n"&gt;wiaacmgr&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;扫描仪和照相机向导&lt;/span&gt;
&lt;span class="n"&gt;winchat&lt;/span&gt;&lt;span class="err"&gt;            &lt;/span&gt;&lt;span class="n"&gt;xp&lt;/span&gt;&lt;span class="err"&gt;自带局域网聊天&lt;/span&gt;
&lt;span class="n"&gt;mem&lt;/span&gt;&lt;span class="err"&gt;                显示内存使用情况&lt;/span&gt;
&lt;span class="n"&gt;mplayer2&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;简易&lt;/span&gt;&lt;span class="n"&gt;widnows&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="n"&gt;media&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="n"&gt;player&lt;/span&gt;
&lt;span class="n"&gt;magnify&lt;/span&gt;&lt;span class="err"&gt;            放大镜实用程序&lt;/span&gt;
&lt;span class="n"&gt;mmc&lt;/span&gt;&lt;span class="err"&gt;                打开控制台&lt;/span&gt;
&lt;span class="n"&gt;mobsync&lt;/span&gt;&lt;span class="err"&gt;            同步命令&lt;/span&gt;
&lt;span class="n"&gt;drwtsn32&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;系统医生&lt;/span&gt;
&lt;span class="n"&gt;dfrg&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;磁盘碎片整理程序&lt;/span&gt;
&lt;span class="n"&gt;diskmgmt&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;      &lt;/span&gt; &lt;span class="err"&gt;磁盘管理实用程序&lt;/span&gt;
&lt;span class="n"&gt;dcomcnfg&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;打开系统组件服务&lt;/span&gt;
&lt;span class="n"&gt;ddeshare&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;打开&lt;/span&gt;&lt;span class="n"&gt;dde&lt;/span&gt;&lt;span class="err"&gt;共享设置&lt;/span&gt;
&lt;span class="n"&gt;dvdplay&lt;/span&gt;&lt;span class="err"&gt;            &lt;/span&gt;&lt;span class="n"&gt;dvd&lt;/span&gt;&lt;span class="err"&gt;播放器&lt;/span&gt;
&lt;span class="n"&gt;nslookup&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;网络管理的工具向导&lt;/span&gt;
&lt;span class="n"&gt;ntbackup&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;系统备份和还原&lt;/span&gt;
&lt;span class="n"&gt;narrator&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;屏幕“讲述人”&lt;/span&gt;
&lt;span class="n"&gt;ntmsmgr&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;        移动存储管理器&lt;/span&gt;
&lt;span class="n"&gt;ntmsoprq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;      &lt;/span&gt; &lt;span class="err"&gt;移动存储管理员操作请求&lt;/span&gt;
&lt;span class="n"&gt;netstat&lt;/span&gt;&lt;span class="err"&gt;  &lt;/span&gt;&lt;span class="n"&gt;an&lt;/span&gt;&lt;span class="err"&gt;        &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;命令检查接口&lt;/span&gt;
&lt;span class="n"&gt;syncapp&lt;/span&gt;&lt;span class="err"&gt;            创建一个公文包&lt;/span&gt;
&lt;span class="n"&gt;sysedit&lt;/span&gt;&lt;span class="err"&gt;            系统配置编辑器&lt;/span&gt;
&lt;span class="n"&gt;sigverif&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;文件签名验证程序&lt;/span&gt;
&lt;span class="n"&gt;sndrec32&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;录音机&lt;/span&gt;
&lt;span class="n"&gt;shrpubw&lt;/span&gt;&lt;span class="err"&gt;            创建共享文件夹&lt;/span&gt;
&lt;span class="n"&gt;secpol&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;        &lt;/span&gt; &lt;span class="err"&gt;本地安全策略&lt;/span&gt;
&lt;span class="n"&gt;syskey&lt;/span&gt;&lt;span class="err"&gt;            &lt;/span&gt; &lt;span class="err"&gt;系统加密，一旦加密就不能解开，保护&lt;/span&gt;&lt;span class="n"&gt;windows&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="n"&gt;xp&lt;/span&gt;&lt;span class="err"&gt;系统的双重密码&lt;/span&gt;
&lt;span class="n"&gt;sfc&lt;/span&gt;&lt;span class="err"&gt;                系统文件检查器&lt;/span&gt;
&lt;span class="n"&gt;sfc&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;scannow&lt;/span&gt;&lt;span class="err"&gt;       &lt;/span&gt;&lt;span class="n"&gt;windows&lt;/span&gt;&lt;span class="err"&gt;文件保护&lt;/span&gt;
&lt;span class="n"&gt;tsshutdn&lt;/span&gt;&lt;span class="err"&gt;           &lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="err"&gt;秒倒计时关机命令&lt;/span&gt;
&lt;span class="n"&gt;tourstart&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt;&lt;span class="n"&gt;xp&lt;/span&gt;&lt;span class="err"&gt;简介（安装完成后出现的漫游&lt;/span&gt;&lt;span class="n"&gt;xp&lt;/span&gt;&lt;span class="err"&gt;程序）&lt;/span&gt;
&lt;span class="n"&gt;eventvwr&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;事件查看器&lt;/span&gt;
&lt;span class="n"&gt;eudcedit&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;造字程序&lt;/span&gt;
&lt;span class="n"&gt;packager&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;对象包装程序&lt;/span&gt;
&lt;span class="n"&gt;perfmon&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;        计算机性能监测程序&lt;/span&gt;
&lt;span class="n"&gt;progman&lt;/span&gt;&lt;span class="err"&gt;            程序管理器&lt;/span&gt;
&lt;span class="n"&gt;rsop&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;组策略结果集&lt;/span&gt;
&lt;span class="n"&gt;rononce&lt;/span&gt;&lt;span class="err"&gt;  &lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="err"&gt;         &lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="err"&gt;秒关机&lt;/span&gt;
&lt;span class="n"&gt;chkdsk&lt;/span&gt;&lt;span class="err"&gt;             &lt;/span&gt;&lt;span class="n"&gt;chkdsk&lt;/span&gt;&lt;span class="err"&gt;磁盘检查&lt;/span&gt;
&lt;span class="n"&gt;certmgr&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;        证书管理实用程序&lt;/span&gt;
&lt;span class="n"&gt;charmap&lt;/span&gt;&lt;span class="err"&gt;            启动字符映射表&lt;/span&gt;
&lt;span class="n"&gt;cliconfg&lt;/span&gt;&lt;span class="err"&gt;           &lt;/span&gt;&lt;span class="n"&gt;sql&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="err"&gt; 客户端网络实用程序&lt;/span&gt;
&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="err"&gt;              &lt;/span&gt; &lt;span class="err"&gt;启动&lt;/span&gt;&lt;span class="n"&gt;netmeeting&lt;/span&gt;
&lt;span class="n"&gt;cleanmgr&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;垃圾整理&lt;/span&gt;
&lt;span class="n"&gt;ciadv&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;          索引服务程序&lt;/span&gt;
&lt;span class="n"&gt;odbcad32&lt;/span&gt;&lt;span class="err"&gt;           &lt;/span&gt;&lt;span class="n"&gt;odbc&lt;/span&gt;&lt;span class="err"&gt;数据源管理器&lt;/span&gt;
&lt;span class="n"&gt;oobe&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;msoobe&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="err"&gt;    &lt;/span&gt; &lt;span class="err"&gt;检查&lt;/span&gt;&lt;span class="n"&gt;xp&lt;/span&gt;&lt;span class="err"&gt;是否激活&lt;/span&gt;
&lt;span class="n"&gt;lusrmgr&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;        本机用户和组&lt;/span&gt;
&lt;span class="n"&gt;iexpress&lt;/span&gt;&lt;span class="err"&gt;          &lt;/span&gt; &lt;span class="err"&gt;木马捆绑工具，系统自带&lt;/span&gt;
&lt;span class="n"&gt;fsmgmt&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msc&lt;/span&gt;&lt;span class="err"&gt;        &lt;/span&gt; &lt;span class="err"&gt;共享文件夹管理器&lt;/span&gt;
&lt;span class="n"&gt;utilman&lt;/span&gt;&lt;span class="err"&gt;            辅助工具管理器&lt;/span&gt;
&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="n"&gt;messenger&lt;/span&gt;&lt;span class="err"&gt; 停止信使服务&lt;/span&gt;
&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="err"&gt; &lt;/span&gt;&lt;span class="n"&gt;messenger&lt;/span&gt;&lt;span class="err"&gt;开始信使服务&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</summary><category term="Windows"></category><category term="Windows XP"></category></entry><entry><title>无法定位程序输入点_except_handler4_common于动态链接库msvcrt.dll上的解决方法</title><link href="http://yysfire.github.io/windows/Unable-to-locate-the-program-input-on-points-_except_handler4_common-in-the-dynamic-link-library-msvcrt.dll.html" rel="alternate"></link><updated>2011-03-09T16:53:00+08:00</updated><author><name>Yysfire</name></author><id>tag:yysfire.github.io,2011-03-09:windows/Unable-to-locate-the-program-input-on-points-_except_handler4_common-in-the-dynamic-link-library-msvcrt.dll.html</id><summary type="html">&lt;p&gt;最近，多种软件都出现了一个启动时的错误提示
“无法定位程序输入点_except_handler4_common于动态链接库msvcrt.dll上”。&lt;/p&gt;
&lt;p&gt;出现这个提示情况是：Windows Xp 系统。&lt;/p&gt;
&lt;p&gt;这个提示出现后，点击确定，并不影响程序的使用。这个问题出现的原因，其实是微软自己的问题，可谓是微软的 Vista 后遗症吧。&lt;/p&gt;
&lt;p&gt;在 Vista 系统里，有个挺酷的功能，就是“程序缩略图”，有点3D效果，这个功能，调用了 dwmapi.dll 这个库，而 dwmapi.dll 又引用了 msvcrt.dll 中的_except_handler4_common 功能。&lt;/p&gt;
&lt;p&gt;然而，在XP系统中，系统自带的 msvcrt.dll 和 Vista 中的 msvcrt.dll 版本不同， 并没有这个_except_handler4_common ，结果就出现了启动程序时，遇到的
“无法定位程序输入点_except_handler4_common于动态链接库msvcrt.dll上”的错误提示。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决方法：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;将 c:\windows\system32 下的 dwmapi.dll 改名，例如：改为 dwmapi.dll.bak。&lt;/p&gt;
&lt;p&gt;这样就OK了。&lt;/p&gt;</summary><category term="Windows"></category><category term="Windows XP"></category></entry><entry><title>IE代理服务器无法设置的解决方法</title><link href="http://yysfire.github.io/windows/Solution_of_IE_proxy_server_can_not_be_set.html" rel="alternate"></link><updated>2010-10-29T09:21:00+08:00</updated><author><name>Yysfire</name></author><id>tag:yysfire.github.io,2010-10-29:windows/Solution_of_IE_proxy_server_can_not_be_set.html</id><summary type="html">&lt;p&gt;今天遇到了IE的代理服务器无法设置的问题，局域网设置对话框里，“代理服务器”一栏是灰色的，无法更改，而且Internet
选项的“连接”标签页的下面有个警告：“某些设置由系统管理员管理”，如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img alt="IE代理服务器无法设置的解决方法" src="http://img848.ph.126.net/ll-6EfQ_gZR8iLvJOGT1Hw==/697776467267677760.png" title="IE代理服务器无法设置的解决方法" /&gt;&lt;/p&gt;
&lt;p&gt;而我的电脑就只有Administrator一个用户，我就是系统管理员。&lt;/p&gt;
&lt;p&gt;最后的解决办法是：&lt;/p&gt;
&lt;p&gt;1、单击“开始－＞运行”，输入“gpedit.msc”打开组策略，依次展开“用户配置－＞管理模板－＞Windows组件－＞Internet
Explorer”，然后将右侧窗口中的“禁用更改代理服务器设置”策略改成“未配置”或“已禁用”。&lt;/p&gt;
&lt;p&gt;2、再展开组策略“计算机配置－＞管理模板－＞Windows组件－＞Internet
Explorer”，在右侧窗口将“禁用更改代理服务器设置”改成“未配置”或“已禁用”即可。&lt;/p&gt;
&lt;p&gt;如果这样仍然没有解决，就去看看注册表里有没有开启代理：&lt;/p&gt;
&lt;p&gt;1、单击“开始－＞运行”，输入“regedit”打开注册表编辑器。&lt;/p&gt;
&lt;p&gt;2.、进入&lt;code&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&lt;/code&gt;子键，在Internet Settings子键下的右窗口中双击ProxyEnable，将该键值项的值由系统默认的“0”修改为“1”（若改为“0”，表示不启用代理服务器功能）。&lt;/p&gt;
&lt;p&gt;3、进入&lt;code&gt;HKEY_CURRENT_CONFIG\Software\Windows\CurrentVersion\Internet Settings&lt;/code&gt;子键，将右窗口中的ProxyEnable的值改为“1”。&lt;/p&gt;
&lt;p&gt;以前还遇到过一个问题，就是局域网设置对话框的“使用自动配置脚本”的地址栏里始终无法清空，重启IE后又被填上了，解决办法就是打开注册表编辑器，打开查找对话框，搜索数据为该地址栏内容的项，将它们的值全部清空。&lt;/p&gt;
&lt;p&gt;&lt;img alt="IE代理服务器无法设置的解决方法" src="http://img839.ph.126.net/0CWscxY_9velnSckxQGpkA==/783344860187570084.png" title="IE代理服务器无法设置的解决方法" /&gt;&lt;/p&gt;</summary><category term="Windows"></category><category term="IE"></category><category term="Proxy"></category></entry><entry><title>为文件夹修改背景，轻松打造个人系统</title><link href="http://yysfire.github.io/windows/change_background_of_fold_in_windows_xp.html" rel="alternate"></link><updated>2007-05-21T13:43:00+08:00</updated><author><name>Yysfire</name></author><id>tag:yysfire.github.io,2007-05-21:windows/change_background_of_fold_in_windows_xp.html</id><summary type="html">&lt;p&gt;对于xp系统的桌面大家一定会精心挑选，因为这是个面子工程，不仅每天开机第一眼看到的就是它，而且自己的朋友或者同学也会经常光顾，xp系统下的桌面背景我们可以任意修改，不过你有没有想过修改文件夹的背景呢？其实在win2k环境下我们可以修改的，不过到了微软开发的xp系统好像把这一功能去除了，但是还是有一些爱好者制造了一些修改文件夹背景的软件，其实不借助任何软件，我们自己也可以修改，下面我就给大家介绍一下具体的方法。&lt;/p&gt;
&lt;h2 id="_1"&gt;修改根目录文件夹背景&lt;/h2&gt;
&lt;p&gt;1、首先在“文件夹选项”里的把“隐藏已知文件类型的扩展名”前的勾去掉，再在分区根目录下（比如D盘下）新建一个叫
Desktop.ini 的文件（如果已经有此文件，则直接复制下列代码到该文件）&lt;/p&gt;
&lt;p&gt;2、复制下面的代码到到文件里：&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="k"&gt;[{BE098140-A513-11D0-A3A4-00C04FD706EC}]&lt;/span&gt;
&lt;span class="na"&gt;IconArea_Image&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;1.JPG&lt;/span&gt;
&lt;span class="k"&gt;[ExtShellFolderViews]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;3、保存文件。&lt;/p&gt;
&lt;p&gt;4、修改文件：1.JPG 是我使用的背景图的名字，大家把它去掉。然后把你想要的图片（最好是1024*740大小的）复制到根目录D盘下，然后把名字复制到
“IconArea_Image=” 的等号的后面。保存文件，刷新，背景就出来了。
      
这一方法只能修改根目录下的文件夹背景，如果想修改任意子文件夹下的背景该怎么办呢？&lt;/p&gt;
&lt;h2 id="_2"&gt;更改子级文件夹的背景&lt;/h2&gt;
&lt;p&gt;首先需要做的是在子文件夹下生成一个desktop.ini文件，下面就以D盘下wma文件夹更换背景为例：&lt;/p&gt;
&lt;p&gt;1、右键点wma文件夹，选择“属性”，选“自定义”，找到“更改文件夹图标”选项，选择它，然后确定。此时你的文件夹图标已经更换，desktop.ini文件也会自动生成，不过是隐藏的，要先修改先把它显示出来才可以（方法很简单我就不说了）。&lt;/p&gt;
&lt;p&gt;2、然后到e:\wma下找到那个生成的desktop.ini文件，双击打开就会发现他已经有了以下代码：&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="k"&gt;[.ShellClassInfo]&lt;/span&gt;
&lt;span class="na"&gt;IconFile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;%SystemRoot%\\system32\\SHELL32.dll&lt;/span&gt;
&lt;span class="na"&gt;IconIndex&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;20&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;这里我解释一下：
其中“iconindex=20”表示使用的图标是指定文件中的第20个图标，“iconfile=%SystemRoot%\system32\SHELL32.dll”表示文件夹使用的图标文件的路径。&lt;/p&gt;
&lt;p&gt;3、然后再copy一个图片（比如1.JPG）到wma文件夹下，接着在已有的代码下加上下列代码：&lt;/p&gt;
&lt;table class="codehilitetable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="k"&gt;[extshellfolderviews]&lt;/span&gt;
&lt;span class="na"&gt;{be098140-a513-11d0-a3a4-00c04fd706ec}&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;{be098140-a513-11d0-a3a4-00c04fd706ec}&lt;/span&gt;
&lt;span class="k"&gt;[{be098140-a513-11d0-a3a4-00c04fd706ec}]&lt;/span&gt;
&lt;span class="na"&gt;attributes&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;1&lt;/span&gt;
&lt;span class="na"&gt;iconarea_image&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;1.JPG&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;然后保存，再刷新一下是不是看到结果了（如果你觉得图片碍眼，就可以把它设为隐藏）。&lt;/p&gt;</summary><category term="Windows"></category><category term="Windows XP"></category></entry></feed>